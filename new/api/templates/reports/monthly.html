<!DOCTYPE html>
<html lang="en">
  <head>
    <title>Cycle Status Report</title>
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <link
      rel="stylesheet"
      href="https://maxcdn.bootstrapcdn.com/bootstrap/3.4.1/css/bootstrap.min.css"
    />
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.4.1/js/bootstrap.min.js"></script>

    <link
      rel="stylesheet"
      href="{{ url_for('static', filename='css/status_report.css') }}"
    />
    <link
      rel="stylesheet"
      href="{{ url_for('static', filename='css/styles.css') }}"
    />
    <link
      rel="shortcut icon"
      href="{{ url_for('static', filename='image/favicon.ico') }}"
    />
    <script src="{{ url_for('static', filename='js/Chart.min.js') }}"></script>
    <script src="{{ url_for('static', filename='js/reports.js') }}"></script>
  </head>
  <body class="mat-typography">
    <div style="width: 8.5in" class="p-0">
      <article>
        <!-- Top blue banner -->
        <header>
          <div class="topBanner">
            <div class="container-fluid">
              <div class="topBannerRow">
                <div class="col-12">
                  <div id="bluePhishLogo">
                    <img
                      src="{{ url_for('static', filename='image/Con-PCA_logo.svg') }}"
                      alt="Continuous Phishing Campaign Assessment Logo"
                    />
                  </div>
                </div>
              </div>
            </div>
          </div>
        </header>
        <main>
          <div class="container-fluid">
            <div class="row">
              <!-- Left side bar -->
              <aside style="min-height: 1225px">
                <div id="reportDate">
                  <h3>
                    {{ cycle.start_date.strftime('%b %d, %Y') }} - {{
                    cycle.end_date.strftime('%b %d, %Y') }}
                  </h3>
                </div>
                <div id="gonePhishingImage">
                  <img
                    src="{{ url_for('static', filename='image/gone_phishing.jpg') }}"
                    alt="Gone Phishing"
                  />
                </div>
                <div id="primaryContact">
                  <span>Primary Contact Information</span><br />
                  <h2>
                    {{ subscription.primary_contact.first_name }} {{
                    subscription.primary_contact.last_name }}
                  </h2>
                  {{ customer.address_1 }} <br />
                  {{ customer.city }}, {{ customer.state }} {{ customer.zip_code
                  }} USA <br />
                  {{ subscription.primary_contact.email }} <br />
                  <br />
                  Admin Contact Information: <br />
                  {{ subscription.admin_email }} <br />
                </div>
                <div id="numbersTitle">
                  <h2>Overall Campaign Numbers</h2>
                </div>
                <div id="campaignNumbers">
                  Total Emails Sent: {{ stats.stats.all.sent.count }} <br />
                  Email Click Rate: {{ stats.stats.all.clicked.ratio * 100 }}%
                  <br />
                </div>
                <div id="preparedFor">
                  Prepared for <br />
                  <span>{{ customer.name }}</span>
                </div>
              </aside>

              <!-- Right 2/3 of the screen -->
              <div class="main-content">
                <div id="reportTitle">
                  <img
                    src="{{ url_for('static', filename='image/title.svg') }}"
                    alt="Monthly Subscription Report"
                  />
                </div>
                <div class="data-report">
                  <!-- Averages -->
                  <div class="row">
                    <div class="col-5">
                      <div id="averageClickTitle">
                        <h3>
                          Average Time <br />
                          to First Click
                        </h3>
                      </div>
                      <div id="averageClickTime">
                        <span style="display: block"
                          >{{
                          time.convert_seconds(stats.stats.all.clicked.average)
                          }}</span
                        >
                      </div>
                    </div>
                    <div class="col-5">
                      <div id="averageClickTitle">
                        <h3>
                          Average Time <br />
                          to First Report
                        </h3>
                      </div>
                      <div id="averageClickTime">
                        <span style="display: block">00:00:00</span>
                      </div>
                    </div>
                  </div>
                  <div class="row yellow-circle-container">
                    <div class="col-5">
                      <div class="circles">
                        <img
                          src="{{ url_for('static', filename='image/dotted_circle.svg') }}"
                          alt="Yellow dotted circle outline"
                        />
                      </div>
                    </div>
                    <div class="col-5">
                      <div class="circles">
                        <img
                          src="{{ url_for('static', filename='image/dotted_circle.svg') }}"
                          alt="Yellow dotted circle outline"
                        />
                      </div>
                    </div>
                  </div>
                  <!-- Campaign Progress -->
                  <div class="row">
                    <div class="col-10">
                      <div id="campaignProgressText">
                        <ul>
                          <li>
                            This Report has been generated in Q1 of your
                            phishing subscription
                          </li>
                          <li>
                            Of the total {{ cycle.target_count }} targets in
                            this cycle, {{ stats.stats.all.sent.count }} targets
                            have had emails sent.
                          </li>
                          <li>
                            The most clicked template indicators for this cycle
                            so far have been:
                          </li>
                          <ul>
                            100.0% Greed (No) : 1 clicks
                          </ul>
                          <ul>
                            100.0% Greed (No) : 1 clicks
                          </ul>
                          <ul>
                            100.0% Greed (No) : 1 clicks
                          </ul>
                          <ul>
                            100.0% Greed (No) : 1 clicks
                          </ul>
                          <ul>
                            100.0% Greed (No) : 1 clicks
                          </ul>
                        </ul>
                      </div>
                    </div>
                  </div>
                  <!-- Donut Charts -->
                  <div class="row">
                    <div class="col-12">
                      <div id="donut-charts">
                        <div class="col-3">
                          <canvas id="doughnut-sent">
                            <script>
                              createDoughnut(
                                "doughnut-sent",
                                "{{ stats.stats.all.sent.count }}",
                                "{{ cycle.target_count }}"
                              );
                            </script>
                          </canvas>
                          <p class="donut-caption">
                            Emails Sent of Total Targets
                          </p>
                        </div>
                        <div class="col-3">
                          <canvas id="doughnut-opened">
                            <script>
                              createDoughnut(
                                "doughnut-opened",
                                "{{ stats.stats.all.opened.count }}",
                                "{{ stats.stats.all.sent.count }}"
                              );
                            </script>
                          </canvas>
                          <p class="donut-caption">Emails Opened of Sent</p>
                        </div>

                        <div class="col-3">
                          <canvas id="doughnut-clicked">
                            <script>
                              createDoughnut(
                                "doughnut-clicked",
                                "{{ stats.stats.all.clicked.count }}",
                                "{{ cycle.target_count }}"
                              );
                            </script>
                          </canvas>
                          <p class="donut-caption">Emails Clicked of Total</p>
                        </div>
                      </div>
                    </div>
                  </div>
                  <!-- Bar Chart -->
                  <div class="row">
                    <div class="col-10 container-fluid">
                      <div class="bar-chart m-2">
                        <h2>STATISTICS BY LEVEL</h2>
                        <canvas
                          id="bar-stats-by-level"
                          class="d-flex report-chart"
                          style="height: 15rem"
                        >
                          <script>
                            createStatsByLevelChart(
                              "bar-stats-by-level",
                              "{{ stats.stats.low.sent.count }}",
                              "{{ stats.stats.low.opened.count }}",
                              "{{ stats.stats.low.clicked.count }}",
                              "{{ stats.stats.moderate.sent.count }}",
                              "{{ stats.stats.moderate.opened.count }}",
                              "{{ stats.stats.moderate.clicked.count }}",
                              "{{ stats.stats.high.sent.count }}",
                              "{{ stats.stats.high.opened.count }}",
                              "{{ stats.stats.high.clicked.count }}"
                            );
                          </script>
                        </canvas>
                      </div>
                    </div>
                  </div>
                </div>
              </div>
            </div>
          </div>
        </main>
      </article>
    </div>
  </body>
</html>
